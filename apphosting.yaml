# Firebase App Hosting – Next.js server app
# Docs: https://firebase.google.com/docs/app-hosting/configure

# Cloud Run service (server)
# maxInstances: 1 = tijdens testen maximaal 1 instance (beperkt kosten)
runConfig:
  minInstances: 0
  maxInstances: 1
  concurrency: 80
  cpu: 1
  memoryMiB: 1024

# Environment variables (converted from .env.local).
# Fill values in Firebase Console (App Hosting → backend → Environment) or replace "" below.
# For FIREBASE_SERVICE_ACCOUNT_KEY: run firebase apphosting:secrets:set FIREBASE_SERVICE_ACCOUNT_KEY and paste the service account JSON.
env:
  - variable: NEXT_PUBLIC_FIREBASE_API_KEY
    value: "AIzaSyBWHWHKvX_L3i8FVs4w1QelhF_F22pJszw"
    availability: [BUILD, RUNTIME]
  - variable: NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN
    value: "scoreboard-35372.firebaseapp.com"
    availability: [BUILD, RUNTIME]
  - variable: NEXT_PUBLIC_FIREBASE_PROJECT_ID
    value: "scoreboard-35372"
    availability: [BUILD, RUNTIME]
  - variable: NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET
    value: "scoreboard-35372.appspot.com"
    availability: [BUILD, RUNTIME]
  - variable: NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID
    value: "436218732725"
    availability: [BUILD, RUNTIME]
  - variable: NEXT_PUBLIC_FIREBASE_APP_ID
    value: "1:436218732725:web:bbe0aa65a9cc7662e95efc"
    availability: [BUILD, RUNTIME]
  - variable: NEXT_PUBLIC_APP_URL
    value: "clubmatch--scoreboard-35372.europe-west4.hosted.app"
    availability: [BUILD, RUNTIME]
  - variable: FIREBASE_SERVICE_ACCOUNT_KEY
    secret: FIREBASE_SERVICE_ACCOUNT_KEY

# Optional: override build/run (defaults work for Next.js)
# Elke build krijgt een unieke NEXT_PUBLIC_BUILD_ID (timestamp), getoond rechtsonder in het dashboard.
# Geen version-bump workflow meer nodig → geen dubbele build, geen rollout-conflict.
scripts:
  buildCommand: export NEXT_PUBLIC_BUILD_ID=$(TZ=Europe/Amsterdam date +%d%m%YY-%H%M) && npm run build
#   runCommand: npm start
